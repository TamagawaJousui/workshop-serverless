service: workshop-serverless
frameworkVersion: "3"

provider:
  name: aws
  runtime: nodejs20.x

# useDotenv: true

functions:
  createUser:
    handler: src/endpoints/user/createUserHandler.handler
    events:
      - httpApi:
          path: /users/register
          method: post
  authUser:
    handler: src/endpoints/user/authUserHandler.handler
    events:
      - httpApi:
          path: /users/auth
          method: post
    # environment:
    #   JWT_SECRET: ${env:JWT_SECRET}
  addWorkshop:
    handler: src/workshop/addWorkshop.handler
    events:
      - httpApi:
          path: /workshops/
          method: post
  getWorkshop:
    handler: src/workshop/getWorkshop.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}
          method: get
  listWorkshops:
    handler: src/workshop/listWorkshops.handler
    events:
      - httpApi:
          path: /workshops/
          method: get
  updateWorkshop:
    handler: src/workshop/updateWorkshop.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}
          method: put
  deleteWorkshop:
    handler: src/workshop/deleteWorkshop.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}
          method: delete
  createParticipation:
    handler: src/participation/createParticipation.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}/participants/
          method: post
  deleteParticipation:
    handler: src/participation/deleteParticipation.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}/participants/
          method: delete
  listParticipants:
    handler: src/participation/listParticipants.handler
    events:
      - httpApi:
          path: /workshops/{workshop_UUID}/participants/
          method: get
  createReview:
    handler: src/review/createReview.handler
    events:
      - httpApi:
          path: /workshops/reviews/
          method: post

plugins:
  - serverless-esbuild
  - serverless-offline
